<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸Šæµ·äº¤é€šå¤§å­¦é£Ÿå ‚ç¤¾åŒº</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .canteen-grid {
            display: flex;
            flex-direction: column;
            gap: 30px;
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .canteen-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            width: 100%;
        }

        .canteen-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .canteen-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .canteen-title:hover {
            color: #3498db;
        }

        .canteen-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .canteen-toggle-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s ease;
        }

        .canteen-toggle-btn:hover {
            background: #c0392b;
        }

        .stalls-container {
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .stalls-container.collapsed {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }

        .stalls-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stall {
            background: white;
            border-radius: 12px;
            padding: 15px;
            border-left: 4px solid #e74c3c;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

        .stall:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .stall-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .stall-name {
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.1em;
            cursor: pointer;
        }

        .toggle-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.3s ease;
        }

        .toggle-btn:hover {
            background: #2980b9;
        }

        .dishes {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .dishes.collapsed {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }


        .stall-rating {
            background: #f39c12;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }

        .dishes {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .dish {
            background: #ecf0f1;
            border-radius: 8px;
            padding: 10px;
            border: 1px solid #bdc3c7;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dish:hover {
            background: #d5dbdb;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .dish-name {
            font-weight: bold;
            color: #34495e;
            margin-bottom: 5px;
        }

        .dish-price {
            color: #e74c3c;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .dish-attributes {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .attribute-tag {
            background: #3498db;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.8em;
        }

        .spicy-tag {
            background: #e74c3c;
        }

        .heat-tag {
            background: #f39c12;
        }

        .onion-tag {
            background: #27ae60;
        }

        /* å¼¹çª—æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #000;
        }

        .modal-header {
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5em;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .rating-display {
            background: #f39c12;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
        }

        .comments-section {
            margin-top: 20px;
        }

        .comment {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .comment-author {
            font-weight: bold;
            color: #2c3e50;
        }

        .comment-rating {
            color: #f39c12;
            font-weight: bold;
        }

        .comment-date {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .comment-text {
            color: #34495e;
            line-height: 1.5;
        }

        .add-comment {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .add-comment h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .comment-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comment-input {
            padding: 10px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 1em;
            resize: vertical;
            min-height: 80px;
        }

        .comment-input:focus {
            outline: none;
            border-color: #3498db;
        }

        .rating-input {
            padding: 8px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 1em;
        }

        .submit-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s ease;
        }

        .submit-btn:hover {
            background: #2980b9;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .search-bar {
            margin: 20px 30px;
            text-align: center;
        }

        .search-input {
            width: 100%;
            max-width: 500px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1.1em;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: #3498db;
        }

        .filter-section {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .filter-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .filter-group {
            margin-bottom: 20px;
        }

        .filter-group h4 {
            color: #34495e;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .filter-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.3s ease;
            font-size: 0.9em;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #2980b9;
        }

        .price-range {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .price-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            text-align: center;
        }

        .price-input:focus {
            outline: none;
            border-color: #3498db;
        }

        .rating-range {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .rating-input {
            width: 60px;
            padding: 8px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            text-align: center;
        }

        .rating-input:focus {
            outline: none;
            border-color: #3498db;
        }

        .stats {
            background: #ecf0f1;
            padding: 20px;
            margin: 20px 30px;
            border-radius: 10px;
            text-align: center;
        }

        .stats h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .canteen-grid {
                padding: 15px;
            }
            
            .stalls-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .canteen-title {
                font-size: 1.5em;
            }
            
            .dishes {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .stalls-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ½ï¸ ä¸Šæµ·äº¤é€šå¤§å­¦é£Ÿå ‚ç¤¾åŒº</h1>
            <p>å‘ç°ç¾é£Ÿï¼Œåˆ†äº«ä½“éªŒï¼Œè®©æ¯ä¸€é¤éƒ½æ›´ç²¾å½©</p>
        </div>

        <div class="search-bar">
            <input type="text" class="search-input" placeholder="æœç´¢èœå“ã€æ‘Šä½æˆ–é¤é¥®å¤§æ¥¼..." id="searchInput">
        </div>

        <div class="filter-section">
            <h3>ğŸ” ç­›é€‰æ¡ä»¶</h3>
            
            <div class="filter-group">
                <h4>ğŸŒ¶ï¸ è¾£åº¦ç­›é€‰</h4>
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterBySpicy('all')">å…¨éƒ¨</button>
                    <button class="filter-btn" onclick="filterBySpicy('ä¸è¾£')">ä¸è¾£</button>
                    <button class="filter-btn" onclick="filterBySpicy('å¾®è¾£')">å¾®è¾£</button>
                    <button class="filter-btn" onclick="filterBySpicy('ä¸­è¾£')">ä¸­è¾£</button>
                    <button class="filter-btn" onclick="filterBySpicy('éº»è¾£')">éº»è¾£</button>
                </div>
            </div>

            <div class="filter-group">
                <h4>â­ è¯„åˆ†ç­›é€‰</h4>
                <div class="rating-range">
                    <span>è¯„åˆ†èŒƒå›´ï¼š</span>
                    <input type="number" class="rating-input" id="minRating" placeholder="æœ€ä½" min="1" max="5" step="0.1">
                    <span>-</span>
                    <input type="number" class="rating-input" id="maxRating" placeholder="æœ€é«˜" min="1" max="5" step="0.1">
                    <button class="filter-btn" onclick="filterByRating()">ç­›é€‰è¯„åˆ†</button>
                </div>
            </div>

            <div class="filter-group">
                <h4>ğŸ’° ä»·æ ¼ç­›é€‰</h4>
                <div class="price-range">
                    <span>ä»·æ ¼èŒƒå›´ï¼š</span>
                    <input type="number" class="price-input" id="minPrice" placeholder="æœ€ä½" min="0" step="1">
                    <span>å…ƒ -</span>
                    <input type="number" class="price-input" id="maxPrice" placeholder="æœ€é«˜" min="0" step="1">
                    <span>å…ƒ</span>
                    <button class="filter-btn" onclick="filterByPrice()">ç­›é€‰ä»·æ ¼</button>
                </div>
            </div>

            <div class="filter-group">
                <div class="filter-buttons">
                    <button class="filter-btn" onclick="clearAllFilters()">æ¸…é™¤æ‰€æœ‰ç­›é€‰</button>
                </div>
            </div>
        </div>

        <div class="stats">
            <h3>ğŸ“Š é£Ÿå ‚ç»Ÿè®¡</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <strong>é¤é¥®å¤§æ¥¼</strong><br>
                    <span style="color: #3498db; font-size: 1.5em;">7</span> æ ‹
                </div>
                <div class="stat-item">
                    <strong>æ‘Šä½æ€»æ•°</strong><br>
                    <span style="color: #e74c3c; font-size: 1.5em;">35</span> ä¸ª
                </div>
                <div class="stat-item">
                    <strong>èœå“æ€»æ•°</strong><br>
                    <span style="color: #f39c12; font-size: 1.5em;">156</span> é“
                </div>
                <div class="stat-item">
                    <strong>å¹³å‡è¯„åˆ†</strong><br>
                    <span style="color: #27ae60; font-size: 1.5em;">3.0</span> â­
                </div>
            </div>
        </div>

        <div class="canteen-grid" id="canteenGrid">
            <!-- é¤é¥®å¤§æ¥¼å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <!-- è¯„è®ºå¼¹çª— -->
    <div id="commentModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-header">
                <div class="modal-title" id="modalTitle"></div>
                <div class="rating-display" id="modalRating"></div>
            </div>
            <div class="comments-section">
                <h4>ğŸ’¬ ç”¨æˆ·è¯„ä»·</h4>
                <div id="commentsList"></div>
                <div class="add-comment">
                    <h4>âœï¸ æ·»åŠ è¯„ä»·</h4>
                    <form class="comment-form" id="commentForm">
                        <textarea class="comment-input" id="commentText" placeholder="åˆ†äº«ä½ çš„ç”¨é¤ä½“éªŒ..." required></textarea>
                        <select class="rating-input" id="commentRating" required>
                            <option value="">é€‰æ‹©è¯„åˆ†</option>
                            <option value="1">1â­ - å¾ˆå·®</option>
                            <option value="2">2â­ - ä¸€èˆ¬</option>
                            <option value="3">3â­ - è¿˜è¡Œ</option>
                            <option value="4">4â­ - ä¸é”™</option>
                            <option value="5">5â­ - å¾ˆæ£’</option>
                        </select>
                        <button type="submit" class="submit-btn">æäº¤è¯„ä»·</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è¾£åº¦é€‰é¡¹
        const spicyLevels = ['ä¸è¾£', 'å¾®è¾£', 'ä¸­è¾£', 'éº»è¾£'];
        
        // å…¶ä»–å±æ€§é€‰é¡¹
        const attributes = ['åŠ è‘±', 'é«˜çƒ­é‡', 'ç´ é£Ÿ', 'æ¸…çœŸ', 'ä½ç›', 'æ— ç³–', 'é«˜è›‹ç™½', 'ä½è„‚'];

        // ç”Ÿæˆéšæœºå±æ€§
        function getRandomAttributes() {
            const numAttributes = Math.floor(Math.random() * 3) + 1; // 1-3ä¸ªå±æ€§
            const shuffled = attributes.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, numAttributes);
        }

        // ç”Ÿæˆéšæœºè¾£åº¦
        function getRandomSpicy() {
            return spicyLevels[Math.floor(Math.random() * spicyLevels.length)];
        }

        // ç”Ÿæˆéšæœºè¯„è®º
        function generateRandomComments() {
            const comments = [
                'å‘³é“ä¸é”™ï¼Œåˆ†é‡è¶³ï¼',
                'ä»·æ ¼å®æƒ ï¼Œæ€§ä»·æ¯”é«˜',
                'æœåŠ¡æ€åº¦å¾ˆå¥½',
                'èœå“æ–°é²œï¼Œå£æ„Ÿå¥½',
                'æ’é˜Ÿæ—¶é—´æœ‰ç‚¹é•¿',
                'ç¯å¢ƒå¹²å‡€æ•´æ´',
                'æ¨èå°è¯•ï¼',
                'ä¸‹æ¬¡è¿˜ä¼šå†æ¥',
                'å‘³é“ä¸€èˆ¬ï¼Œæ²¡æœ‰ç‰¹åˆ«æƒŠè‰³',
                'åˆ†é‡æœ‰ç‚¹å°‘ï¼Œåƒä¸é¥±',
                'ä»·æ ¼åè´µï¼Œæ€§ä»·æ¯”ä¸é«˜',
                'å‘³é“å¾ˆæ­£å®—ï¼Œæ¨èï¼',
                'æœåŠ¡é€Ÿåº¦å¾ˆå¿«',
                'ç¯å¢ƒæœ‰ç‚¹åµ',
                'èœå“å¾ˆæ–°é²œï¼Œå£æ„Ÿä¸é”™',
                'æ’é˜Ÿäººå¾ˆå¤šï¼Œç­‰äº†å¥½ä¹…',
                'å‘³é“è¿˜å¯ä»¥ï¼Œä¸­è§„ä¸­çŸ©',
                'åˆ†é‡åˆšå¥½ï¼Œä»·æ ¼åˆç†',
                'æœåŠ¡æ€åº¦ä¸€èˆ¬',
                'ç¯å¢ƒå¾ˆå¹²å‡€ï¼Œç”¨é¤ä½“éªŒå¥½',
                'å‘³é“ä¸é”™ï¼Œå€¼å¾—ä¸€è¯•',
                'ä»·æ ¼æœ‰ç‚¹è´µï¼Œä½†å‘³é“å¥½',
                'åˆ†é‡å¾ˆè¶³ï¼Œæ€§ä»·æ¯”é«˜',
                'æœåŠ¡å¾ˆå‘¨åˆ°ï¼Œå¾ˆæ»¡æ„',
                'ç¯å¢ƒä¸é”™ï¼Œé€‚åˆèšé¤',
                'å‘³é“ä¸€èˆ¬ï¼Œæ²¡æœ‰ç‰¹è‰²',
                'åˆ†é‡å¤ªå°‘ï¼Œä¸å¤Ÿåƒ',
                'ä»·æ ¼åˆç†ï¼Œå‘³é“ä¸é”™',
                'æœåŠ¡æ€åº¦å¾ˆå¥½ï¼Œå¾ˆè´´å¿ƒ',
                'ç¯å¢ƒå¹²å‡€ï¼Œç”¨é¤èˆ’é€‚'
            ];
            
            const authors = ['å°æ˜', 'å°çº¢', 'å°æ', 'å°ç‹', 'å°å¼ ', 'å°åˆ˜', 'å°é™ˆ', 'å°æ¨', 'å°èµµ', 'å°å­™', 'å°å‘¨', 'å°å´', 'å°éƒ‘', 'å°å†¯', 'å°é™ˆ', 'å°è¤š', 'å°å«', 'å°è’‹', 'å°æ²ˆ', 'å°éŸ©'];
            
            const numComments = Math.floor(Math.random() * 5) + 3; // 3-7æ¡è¯„è®º
            const result = [];
            
            for (let i = 0; i < numComments; i++) {
                result.push({
                    author: authors[Math.floor(Math.random() * authors.length)],
                    rating: Math.floor(Math.random() * 5) + 1, // 1-5æ•´æ•°è¯„åˆ†
                    text: comments[Math.floor(Math.random() * comments.length)],
                    date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString()
                });
            }
            
            return result;
        }

        // è®¡ç®—èœå“å¹³å‡è¯„åˆ†
        function calculateDishRating(comments) {
            if (!comments || comments.length === 0) return 3.0;
            const totalRating = comments.reduce((sum, comment) => sum + comment.rating, 0);
            return (totalRating / comments.length).toFixed(1);
        }

        // è®¡ç®—æ‘Šä½å¹³å‡è¯„åˆ†
        function calculateStallRating(dishes) {
            if (!dishes || dishes.length === 0) return 3.0;
            const totalRating = dishes.reduce((sum, dish) => sum + parseFloat(dish.rating), 0);
            return (totalRating / dishes.length).toFixed(1);
        }

        // ç”Ÿæˆèœå“æ•°æ®
        function generateDishes() {
            const dishes = [];
            for (let i = 1; i <= 4; i++) {
                const comments = generateRandomComments();
                dishes.push({
                    name: `èœå“${i}`,
                    price: Math.floor(Math.random() * 20) + 5, // 5-24å…ƒéšæœºä»·æ ¼
                    rating: calculateDishRating(comments),
                    spicy: getRandomSpicy(),
                    attributes: getRandomAttributes(),
                    comments: comments
                });
            }
            return dishes;
        }

        // ç”Ÿæˆæ‘Šä½æ•°æ®
        function generateStalls() {
            const stalls = [];
            for (let i = 1; i <= 5; i++) {
                const dishes = generateDishes();
                stalls.push({
                    name: `æ‘Šä½${i}`,
                    rating: calculateStallRating(dishes),
                    dishes: dishes,
                    comments: generateRandomComments(),
                    collapsed: true  // é»˜è®¤å…¨éƒ¨æŠ˜å 
                });
            }
            return stalls;
        }

        // ç”Ÿæˆé¤é¥®å¤§æ¥¼æ•°æ®
        function generateCanteens() {
            const canteens = [];
            for (let i = 1; i <= 7; i++) {
                if (i === 1) {
                    // ç¬¬ä¸€é¤é¥®å¤§æ¥¼ä½¿ç”¨çœŸå®æ•°æ®
                    canteens.push({
                        name: `ç¬¬${i}é¤é¥®å¤§æ¥¼`,
                        stalls: generateFirstCanteenStalls(),
                        collapsed: true
                    });
                } else {
                    // å…¶ä»–é¤é¥®å¤§æ¥¼ä½¿ç”¨éšæœºæ•°æ®
                    canteens.push({
                        name: `ç¬¬${i}é¤é¥®å¤§æ¥¼`,
                        stalls: generateStalls(),
                        collapsed: true
                    });
                }
            }
            return canteens;
        }

        // ç”Ÿæˆç¬¬ä¸€é¤é¥®å¤§æ¥¼çš„èœå“æ•°æ®ï¼ˆå¸¦è¯„è®ºå’Œè¯„åˆ†è®¡ç®—ï¼‰
        function generateFirstCanteenDish(name, price, spicy, attributes) {
            const comments = generateRandomComments();
            return {
                name: name,
                price: price,
                rating: calculateDishRating(comments),
                spicy: spicy,
                attributes: attributes,
                comments: comments
            };
        }

        // ç”Ÿæˆç¬¬ä¸€é¤é¥®å¤§æ¥¼çš„æ‘Šä½æ•°æ®
        function generateFirstCanteenStalls() {
            const stalls = [];
            
            // æ‘Šä½1ï¼š1-1-1
            const stall1Dishes = [
                generateFirstCanteenDish('ç‰›è‚‰ç²‰ä¸æ±¤', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‰›æ‚ç²‰ä¸æ±¤', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'å’¸']),
                generateFirstCanteenDish('é¦™é…¥è„†é¥¼', 2, 'ä¸è¾£', ['ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('è‘±æ²¹é¥¼', 2, 'ä¸è¾£', ['ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‰›è‚‰ç²‰ä¸é¥¼', 3, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-1',
                rating: calculateStallRating(stall1Dishes),
                dishes: stall1Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½2ï¼š1-1-2
            const stall2Dishes = [
                generateFirstCanteenDish('é¦™æ‹ŒåœŸè±†ç²‰é¦™æ‹ŒäºŒæº', 16, 'ä¸è¾£', ['ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('æ‹›ç‰Œé†‡é¦™åœŸè±†ç²‰', 16, 'å¾®è¾£', ['ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç»å…¸éº»è¾£åœŸè±†ç²‰', 16, 'å¾®è¾£', ['ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç•ªèŒ„åœŸè±†ç²‰', 16, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('ç‰¹è‰²éº»é…±åœŸè±†ç²‰', 17, 'å¾®è¾£', ['ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç™¾é¦™æœé…¸æ±¤åœŸè±†ç²‰', 18, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('ç”Ÿçƒ«ç‰›è‚‰åœŸè±†ç²‰', 19, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-2',
                rating: calculateStallRating(stall2Dishes),
                dishes: stall2Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½3ï¼š1-1-3
            const stall3Dishes = [
                generateFirstCanteenDish('é›ªèœè‚‰ä¸é¢', 10, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç¬‹å°–è‚‰æœ«é¢', 10, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç•ªèŒ„é¸¡è›‹é¢', 10, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('è‚‰æœ«é¢', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‚¸é…±é¢', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('è¾£å­é¸¡é¢', 12, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å¤è‚‰é¢', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é±¼é¦™è‚‰ä¸é¢', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é¦™è¾£ç‰›è‚‰é¢', 16, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-3',
                rating: calculateStallRating(stall3Dishes),
                dishes: stall3Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½4ï¼š1-1-4
            const stall4Dishes = [
                generateFirstCanteenDish('é±¼é¦™è‚‰ä¸å¥—é¤é¥­', 13, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é’æ¤’è‚‰ä¸å¥—é¤é¥­', 13, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç›ç„—é¸¡è…¿å¥—é¤é¥­', 13, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é…¸è¾£é¸¡æ‚å¥—é¤é¥­', 13, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å¥¥å°”è‰¯è…¿æ’å¥—é¤é¥­', 13, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å°ç‚’è‚‰å¥—é¤é¥­', 14, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('è¾£å­é¸¡å¥—é¤é¥­', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å’•å’¾è‚‰å¥—é¤é¥­', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('é¸¡è›‹è‚‰æœ«å¥—é¤é¥­', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('æ¤’ç›å°é…¥è‚‰å¥—é¤é¥­', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é¦™é…¥é¸¡æ’å¥—é¤é¥­', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('çº¢çƒ§è‚‰å¥—é¤é¥­', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-4',
                rating: calculateStallRating(stall4Dishes),
                dishes: stall4Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½5ï¼š1-1-5
            const stall5Dishes = [
                generateFirstCanteenDish('æ²™èŒ¶ç‰›è‚‰ç‚’é¥­', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('æ‰¬å·ç‚’é¥­', 10, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å¹¿å¼è…Šè‚ ç‚’é¥­', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('éŸ©å¼æ³¡èœäº”èŠ±è‚‰ç‚’é¥­', 16, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('æ©„æ¦„èœè™¾ä»ç‚’é¥­', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‰›è‚‰ç‚’é¢', 16, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‰›è‚‰ç‚’æ²³ç²‰', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-5',
                rating: calculateStallRating(stall5Dishes),
                dishes: stall5Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½6ï¼š1-1-6
            const stall6Dishes = [
                generateFirstCanteenDish('å°åº¦å’–å–±é¸¡é¥­', 16, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å°åº¦å’–å–±ç‰›è‚‰é¥­', 19, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å°åº¦å’–å–±é¸¡è›‹é¥­', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‰›æ²¹é£é¥¼', 13, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('è‘±èŠ±é£é¥¼', 13, 'ä¸è¾£', ['é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('èŠéº»é£é¥¼', 12, 'ä¸è¾£', ['ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç«è…¿é£é¥¼', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-6',
                rating: calculateStallRating(stall6Dishes),
                dishes: stall6Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½7ï¼š1-1-7
            const stall7Dishes = [
                generateFirstCanteenDish('æœ¨ç“œå…»é¢œç²¥', 5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('è‘¡è„ç‡•éº¦ç²¥', 4, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('å°ç±³å—ç“œç²¥', 4, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('æ¤°å¥¶è¥¿ç±³éœ²', 5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('é…’é…¿å°ä¸¸å­', 5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('çº¢æ£é“¶è€³æ±¤', 4, 'ä¸è¾£', ['ä½è„‚', 'ç”œ'])
            ];
            
            stalls.push({
                name: '1-1-7',
                rating: calculateStallRating(stall7Dishes),
                dishes: stall7Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½8ï¼š1-1-21
            const stall8Dishes = [
                generateFirstCanteenDish('é¦’å¤´', 0.5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('çƒ§å–', 1.5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('çº¢æ£ç³•', 2, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('é¦™è‡å°ç¬¼åŒ…', 5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('çº¢ç³–ç±³ç³•', 2.5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('å…¬å©†é¥¼', 3.5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç´«èœå·', 2.5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç™½ç³–æ–¹ç³•', 2.5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ'])
            ];
            
            stalls.push({
                name: '1-1-21',
                rating: calculateStallRating(stall8Dishes),
                dishes: stall8Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½9ï¼š1-1-22
            const stall9Dishes = [
                generateFirstCanteenDish('éª¨æ±¤è¿‡æ¡¥ç±³çº¿ï¼ˆç²—ç²‰ï¼‰', 11, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('éª¨æ±¤è¿‡æ¡¥ç±³çº¿ï¼ˆç»†ç²‰ï¼‰', 11, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('åœŸé¸¡è¿‡æ¡¥ç±³çº¿ï¼ˆç²—ç²‰ï¼‰', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('åœŸé¸¡è¿‡æ¡¥ç±³çº¿ï¼ˆç»†ç²‰ï¼‰', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-22',
                rating: calculateStallRating(stall9Dishes),
                dishes: stall9Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½10ï¼š1-1-26
            const stall10Dishes = [
                generateFirstCanteenDish('é…¸æ±¤ç‰›è‚‰æ°´é¥º', 12, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('biangbiangé¢', 22, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('æ²¹æ³¼é¢', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‚¸é…±é¢', 11, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('è‚‰å¤¹é¦', 8, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å²å±±è‡Šå­é¢', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-26',
                rating: calculateStallRating(stall10Dishes),
                dishes: stall10Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½11ï¼š1-1-27
            const stall11Dishes = [
                generateFirstCanteenDish('éº»è¾£é¸¡ä¸è’¸é¢', 12, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é’æ¤’è‚‰ä¸è’¸é¢', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å¤è‚‰è’¸é¢', 14, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é¦™è¾£ç‰›è‚‰è’¸é¢', 18, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-27',
                rating: calculateStallRating(stall11Dishes),
                dishes: stall11Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½12ï¼š1-1-29
            const stall12Dishes = [
                generateFirstCanteenDish('æ‰‹æŠ“é¥¼', 5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é…±é¦™é¥¼', 2.5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç‰›è‚‰é¦…é¥¼', 3.5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('çƒ¤çº¢è–¯', 8, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('å…«å®ç²¥', 2.5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ'])
            ];
            
            stalls.push({
                name: '1-1-29',
                rating: calculateStallRating(stall12Dishes),
                dishes: stall12Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½13ï¼š1-1-30
            const stall13Dishes = [
                generateFirstCanteenDish('å°ç±³ç²¥', 2, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('ç™½ç²¥', 0.5, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('èœç²¥', 2, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('èŒ¶å¶è›‹', 1, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç™½ç…®è›‹', 0.7, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ä¸‰é²œå¤§åŒ…', 1.5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é²œè‚‰å¤§åŒ…', 1.5, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('å¥¶é¦™ç‰ç±³åŒ…', 2, 'ä¸è¾£', ['ä½è„‚', 'ç”œ']),
                generateFirstCanteenDish('èŠ±å·', 1, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-30',
                rating: calculateStallRating(stall13Dishes),
                dishes: stall13Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½14ï¼š1-1-31
            const stall14Dishes = [
                generateFirstCanteenDish('ç‰›è‚‰æ±¤æ³¡é¥¼ä¸', 16, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç¾Šæ‚æ±¤æ³¡é¥¼ä¸', 16, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-31',
                rating: calculateStallRating(stall14Dishes),
                dishes: stall14Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½15ï¼š1-1-32
            const stall15Dishes = [
                generateFirstCanteenDish('è‘±æ²¹æ‹Œé¢', 6, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('é»„ç„–é¸¡é¢ï¼ˆç²‰ï¼‰', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('é…¸è¾£é¸¡ä¸é¢ï¼ˆç²‰ï¼‰', 12, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ä»€é”¦é±¼ä¸¸é¢ï¼ˆç²‰ï¼‰', 12, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('çº¢çƒ§ç‰›è‚‰é¢ï¼ˆç²‰ï¼‰', 16, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-32',
                rating: calculateStallRating(stall15Dishes),
                dishes: stall15Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½16ï¼š1-1-34
            const stall16Dishes = [
                generateFirstCanteenDish('é»‘æ¤’é¸¡æŸ³é¥­', 13, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('é±¼é¦™è‚‰ä¸é¥­', 13, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('æ¤°æ±å’–å–±é¸¡é¥­', 13, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('ç•ªèŒ„ç‰›è‚‰æ»‘è›‹é¥­', 15, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-1-34',
                rating: calculateStallRating(stall16Dishes),
                dishes: stall16Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½17ï¼š1-2-1
            const stall17Dishes = [
                generateFirstCanteenDish('çŒªè„šé¥­', 16, 'ä¸è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('å·é¦™ç‰›è‚‰é¥­', 18, 'å¾®è¾£', ['é«˜è›‹ç™½', 'é«˜è„‚', 'å’¸']),
                generateFirstCanteenDish('é…±é¦™æ’éª¨é¥­', 16, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'ç”œ'])
            ];
            
            stalls.push({
                name: '1-2-1',
                rating: calculateStallRating(stall17Dishes),
                dishes: stall17Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });

            // æ‘Šä½18ï¼š1-2-2
            const stall18Dishes = [
                generateFirstCanteenDish('é¦™è¾£çƒ¤å…¨é±¼é¥­', 22, 'å¾®è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('è’œé¦™çƒ¤å…¨é±¼é¥­', 22, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸']),
                generateFirstCanteenDish('ç•ªèŒ„çƒ¤å…¨é±¼é¥­', 22, 'ä¸è¾£', ['é«˜è›‹ç™½', 'ä½è„‚', 'å’¸'])
            ];
            
            stalls.push({
                name: '1-2-2',
                rating: calculateStallRating(stall18Dishes),
                dishes: stall18Dishes,
                comments: generateRandomComments(),
                collapsed: true
            });
            
            return stalls;
        }

        // æ¸²æŸ“é¤é¥®å¤§æ¥¼
        function renderCanteens(canteens) {
            const grid = document.getElementById('canteenGrid');
            grid.innerHTML = '';

            canteens.forEach(canteen => {
                const canteenCard = document.createElement('div');
                canteenCard.className = 'canteen-card';
                canteenCard.innerHTML = `
                    <div class="canteen-header" onclick="toggleCanteen('${canteen.name}')">
                        <div class="canteen-title">${canteen.name}</div>
                        <button class="canteen-toggle-btn">${canteen.collapsed ? 'å±•å¼€' : 'æŠ˜å '}</button>
                    </div>
                    <div class="stalls-container ${canteen.collapsed ? 'collapsed' : ''}">
                        <div class="stalls-grid">
                            ${canteen.stalls.map((stall, stallIndex) => `
                                <div class="stall">
                                    <div class="stall-header" onclick="toggleStall('${canteen.name}', '${stall.name}')">
                                        <div class="stall-name">${stall.name}</div>
                                        <div style="display: flex; align-items: center;">
                                            <div class="stall-rating">${stall.rating}â­</div>
                                            <button class="toggle-btn">${stall.collapsed ? 'å±•å¼€' : 'æŠ˜å '}</button>
                                        </div>
                                    </div>
                                    <div class="dishes ${stall.collapsed ? 'collapsed' : ''}">
                                        ${stall.dishes.map((dish, dishIndex) => `
                                            <div class="dish" onclick="showComments('${canteen.name}', '${stall.name}', ${dishIndex}, 'dish')">
                                                <div class="dish-name">${dish.name}</div>
                                                <div class="dish-price">Â¥${dish.price}</div>
                                                <div class="dish-rating">${dish.rating}â­</div>
                                                <div class="dish-attributes">
                                                    <span class="attribute-tag spicy-tag">${dish.spicy}</span>
                                                    ${dish.attributes.map(attr => `
                                                        <span class="attribute-tag ${attr === 'åŠ è‘±' ? 'onion-tag' : attr === 'é«˜çƒ­é‡' ? 'heat-tag' : ''}">${attr}</span>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                grid.appendChild(canteenCard);
            });
        }

        // æœç´¢åŠŸèƒ½ - å¢å¼ºç‰ˆæ–‡å­—æ£€ç´¢
        function searchCanteens(query) {
            if (!query.trim()) {
                applyAllFilters();
                return;
            }

            const searchTerms = query.toLowerCase().trim().split(/\s+/);
            
            const filteredCanteens = canteensData.map(canteen => {
                // è·å–å½“å‰é¤é¥®å¤§æ¥¼çš„æœ€æ–°çŠ¶æ€
                const currentCanteen = canteensData.find(c => c.name === canteen.name);
                
                // ç­›é€‰æ¯ä¸ªæ‘Šä½ï¼Œåªä¿ç•™æœ‰åŒ¹é…èœå“çš„æ‘Šä½
                const filteredStalls = currentCanteen.stalls.map(stall => {
                    const filteredDishes = stall.dishes.filter(dish => {
                        // å¢å¼ºçš„æœç´¢æ¡ä»¶
                        const dishText = [
                            dish.name,
                            dish.spicy,
                            dish.description || '',
                            ...dish.attributes,
                            stall.name,
                            currentCanteen.name
                        ].join(' ').toLowerCase();

                        // æ¨¡ç³ŠåŒ¹é…ï¼šæ‰€æœ‰æœç´¢è¯éƒ½å¿…é¡»åœ¨æ–‡æœ¬ä¸­æ‰¾åˆ°
                        const matchesAllTerms = searchTerms.every(term => 
                            dishText.includes(term) ||
                            dish.price.toString().includes(term) ||
                            dish.rating.toString().includes(term)
                        );

                        if (!matchesAllTerms) return false;
                        
                        // åº”ç”¨å½“å‰ç­›é€‰æ¡ä»¶
                        if (currentFilters.spicy !== 'all' && dish.spicy !== currentFilters.spicy) {
                            return false;
                        }
                        
                        const dishRating = parseFloat(dish.rating);
                        if (currentFilters.minRating !== null && dishRating < currentFilters.minRating) {
                            return false;
                        }
                        if (currentFilters.maxRating !== null && dishRating > currentFilters.maxRating) {
                            return false;
                        }
                        
                        if (currentFilters.minPrice !== null && dish.price < currentFilters.minPrice) {
                            return false;
                        }
                        if (currentFilters.maxPrice !== null && dish.price > currentFilters.maxPrice) {
                            return false;
                        }
                        
                        return true;
                    });
                    
                    // å¢å¼ºæ‘Šä½çº§åˆ«çš„æœç´¢
                    const stallText = [
                        stall.name,
                        currentCanteen.name,
                        ...stall.dishes.map(d => d.name),
                        ...stall.dishes.map(d => d.spicy)
                    ].join(' ').toLowerCase();
                    
                    const matchesStall = searchTerms.every(term => 
                        stallText.includes(term) ||
                        stall.rating.toString().includes(term)
                    );

                    // å¦‚æœæœ‰åŒ¹é…çš„èœå“ï¼Œè¿”å›æ–°çš„æ‘Šä½å¯¹è±¡
                    if (filteredDishes.length > 0) {
                        return {
                            name: stall.name,
                            rating: stall.rating,
                            dishes: filteredDishes,
                            comments: stall.comments,
                            collapsed: stall.collapsed  // ä¿æŒåŸå§‹æŠ˜å çŠ¶æ€
                        };
                    } else if (matchesStall) {
                        return {
                            name: stall.name,
                            rating: stall.rating,
                            dishes: stall.dishes,
                            comments: stall.comments,
                            collapsed: stall.collapsed  // ä¿æŒåŸå§‹æŠ˜å çŠ¶æ€
                        };
                    }
                    return null;
                }).filter(stall => stall !== null); // è¿‡æ»¤æ‰æ²¡æœ‰åŒ¹é…èœå“çš„æ‘Šä½

                // å¢å¼ºé¤é¥®å¤§æ¥¼çº§åˆ«çš„æœç´¢
                const canteenText = [
                    currentCanteen.name,
                    ...currentCanteen.stalls.map(s => s.name),
                    ...currentCanteen.stalls.flatMap(s => s.dishes.map(d => d.name))
                ].join(' ').toLowerCase();
                
                const matchesCanteen = searchTerms.every(term => 
                    canteenText.includes(term)
                );

                // å¦‚æœæœ‰åŒ¹é…çš„æ‘Šä½æˆ–é¤é¥®å¤§æ¥¼åŒ¹é…ï¼Œè¿”å›åŸå§‹é¤é¥®å¤§æ¥¼å¯¹è±¡
                if (filteredStalls.length > 0 || matchesCanteen) {
                    return currentCanteen; // è¿”å›åŸå§‹é¤é¥®å¤§æ¥¼å¯¹è±¡ï¼Œä¿æŒå¼•ç”¨
                }
                return null;
            }).filter(canteen => canteen !== null); // è¿‡æ»¤æ‰æ²¡æœ‰æ‘Šä½çš„é¤é¥®å¤§æ¥¼

            renderCanteens(filteredCanteens);
            
            // æ˜¾ç¤ºæœç´¢ç»“æœç»Ÿè®¡
            updateSearchStats(query, filteredCanteens);
        }

        // æœç´¢ç»Ÿè®¡åŠŸèƒ½
        function updateSearchStats(query, results) {
            const totalDishes = results.reduce((sum, canteen) => 
                sum + canteen.stalls.reduce((stallSum, stall) => 
                    stallSum + stall.dishes.length, 0), 0);
            
            const searchStats = document.getElementById('searchStats');
            if (!searchStats) {
                // åˆ›å»ºæœç´¢ç»Ÿè®¡å…ƒç´ 
                const statsDiv = document.createElement('div');
                statsDiv.id = 'searchStats';
                statsDiv.style.cssText = `
                    background: #f8f9fa;
                    padding: 10px 15px;
                    margin: 10px 0;
                    border-radius: 8px;
                    border-left: 4px solid #3498db;
                    font-size: 14px;
                    color: #2c3e50;
                `;
                
                const searchBar = document.querySelector('.search-bar');
                searchBar.appendChild(statsDiv);
            }
            
            const statsDiv = document.getElementById('searchStats');
            if (totalDishes > 0) {
                statsDiv.innerHTML = `ğŸ” æœç´¢ "<strong>${query}</strong>" æ‰¾åˆ° <strong>${totalDishes}</strong> é“èœå“ï¼Œåˆ†å¸ƒåœ¨ <strong>${results.length}</strong> æ ‹é¤é¥®å¤§æ¥¼`;
                statsDiv.style.display = 'block';
            } else {
                statsDiv.innerHTML = `ğŸ” æœç´¢ "<strong>${query}</strong>" æœªæ‰¾åˆ°ç›¸å…³ç»“æœ`;
                statsDiv.style.display = 'block';
            }
        }

        // å…¨å±€ç­›é€‰çŠ¶æ€
        let currentFilters = {
            spicy: 'all',
            minRating: null,
            maxRating: null,
            minPrice: null,
            maxPrice: null
        };

        // æŒ‰è¾£åº¦ç­›é€‰
        function filterBySpicy(spicyLevel) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            currentFilters.spicy = spicyLevel;
            applyAllFilters();
        }

        // æŒ‰è¯„åˆ†ç­›é€‰
        function filterByRating() {
            const minRating = parseFloat(document.getElementById('minRating').value);
            const maxRating = parseFloat(document.getElementById('maxRating').value);
            
            currentFilters.minRating = isNaN(minRating) ? null : minRating;
            currentFilters.maxRating = isNaN(maxRating) ? null : maxRating;
            
            applyAllFilters();
        }

        // æŒ‰ä»·æ ¼ç­›é€‰
        function filterByPrice() {
            const minPrice = parseFloat(document.getElementById('minPrice').value);
            const maxPrice = parseFloat(document.getElementById('maxPrice').value);
            
            currentFilters.minPrice = isNaN(minPrice) ? null : minPrice;
            currentFilters.maxPrice = isNaN(maxPrice) ? null : maxPrice;
            
            applyAllFilters();
        }

        // æ¸…é™¤æ‰€æœ‰ç­›é€‰
        function clearAllFilters() {
            currentFilters = {
                spicy: 'all',
                minRating: null,
                maxRating: null,
                minPrice: null,
                maxPrice: null
            };
            
            // é‡ç½®ç•Œé¢
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('.filter-btn[onclick="filterBySpicy(\'all\')"]').classList.add('active');
            document.getElementById('minRating').value = '';
            document.getElementById('maxRating').value = '';
            document.getElementById('minPrice').value = '';
            document.getElementById('maxPrice').value = '';
            
            applyAllFilters();
        }

        // åº”ç”¨æ‰€æœ‰ç­›é€‰æ¡ä»¶
        function applyAllFilters() {
            // åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼ŒåŒ…å«ç­›é€‰åçš„ç»“æœ
            const filteredCanteens = canteensData.map(canteen => {
                // è·å–å½“å‰é¤é¥®å¤§æ¥¼
                const currentCanteen = canteensData.find(c => c.name === canteen.name);
                
                // ç­›é€‰æ¯ä¸ªæ‘Šä½ï¼Œåˆ›å»ºæ–°çš„æ‘Šä½å¯¹è±¡ï¼ŒåªåŒ…å«ç¬¦åˆæ¡ä»¶çš„èœå“
                const filteredStalls = currentCanteen.stalls.map(stall => {
                    // ç­›é€‰è¯¥æ‘Šä½ä¸­ç¬¦åˆæ¡ä»¶çš„èœå“
                    const filteredDishes = stall.dishes.filter(dish => {
                        // è¾£åº¦ç­›é€‰
                        if (currentFilters.spicy !== 'all' && dish.spicy !== currentFilters.spicy) {
                            return false;
                        }
                        
                        // è¯„åˆ†ç­›é€‰
                        const dishRating = parseFloat(dish.rating);
                        if (currentFilters.minRating !== null && dishRating < currentFilters.minRating) {
                            return false;
                        }
                        if (currentFilters.maxRating !== null && dishRating > currentFilters.maxRating) {
                            return false;
                        }
                        
                        // ä»·æ ¼ç­›é€‰
                        if (currentFilters.minPrice !== null && dish.price < currentFilters.minPrice) {
                            return false;
                        }
                        if (currentFilters.maxPrice !== null && dish.price > currentFilters.maxPrice) {
                            return false;
                        }
                        
                        return true;
                    });
                    
                    // å¦‚æœæœ‰ç¬¦åˆæ¡ä»¶çš„èœå“ï¼Œè¿”å›æ–°çš„æ‘Šä½å¯¹è±¡
                    if (filteredDishes.length > 0) {
                        return {
                            name: stall.name,
                            rating: stall.rating,
                            dishes: filteredDishes,
                            comments: stall.comments,
                            collapsed: stall.collapsed  // ä¿æŒåŸå§‹æŠ˜å çŠ¶æ€
                        };
                    }
                    return null;
                }).filter(stall => stall !== null); // è¿‡æ»¤æ‰æ²¡æœ‰èœå“çš„æ‘Šä½

                // å¦‚æœè¯¥é¤é¥®å¤§æ¥¼è¿˜æœ‰æ‘Šä½ï¼Œè¿”å›æ–°çš„é¤é¥®å¤§æ¥¼å¯¹è±¡
                if (filteredStalls.length > 0) {
                    return {
                        name: currentCanteen.name,
                        stalls: filteredStalls,
                        collapsed: currentCanteen.collapsed  // ä¿æŒåŸå§‹æŠ˜å çŠ¶æ€
                    };
                }
                return null;
            }).filter(canteen => canteen !== null); // è¿‡æ»¤æ‰æ²¡æœ‰æ‘Šä½çš„é¤é¥®å¤§æ¥¼

            renderCanteens(filteredCanteens);
        }

        // å…¨å±€å˜é‡
        let canteensData = generateCanteens();
        let currentModalData = null;

        // åˆ‡æ¢é¤é¥®å¤§æ¥¼æŠ˜å çŠ¶æ€
        function toggleCanteen(canteenName) {
            const canteen = canteensData.find(c => c.name === canteenName);
            if (canteen) {
                canteen.collapsed = !canteen.collapsed;
                // é‡æ–°åº”ç”¨ç­›é€‰æ¡ä»¶ä»¥æ›´æ–°æ˜¾ç¤º
                applyAllFilters();
            }
        }

        // åˆ‡æ¢æ‘Šä½æŠ˜å çŠ¶æ€ï¼ˆä¿®å¤ç­›é€‰çŠ¶æ€ä¸‹æ— æ³•å±•å¼€æ‘Šä½çš„é—®é¢˜ï¼‰
        function toggleStall(canteenName, stallName) {
            const canteen = canteensData.find(c => c.name === canteenName);
            if (!canteen) return;
            
            // åœ¨åŸå§‹æ•°æ®ä¸­æŸ¥æ‰¾å¯¹åº”æ‘Šä½
            const originalStall = canteen.stalls.find(s => s.name === stallName);
            if (!originalStall) return;
            
            // åˆ‡æ¢åŸå§‹æ•°æ®çš„æŠ˜å çŠ¶æ€
            if (originalStall.collapsed) {
                // å±•å¼€å½“å‰æ‘Šä½ï¼ŒæŠ˜å åŒé¤é¥®å¤§æ¥¼å†…å…¶ä»–æ‘Šä½
                canteen.stalls.forEach(stall => {
                    stall.collapsed = true;
                });
                originalStall.collapsed = false;
            } else {
                // æŠ˜å å½“å‰æ‘Šä½
                originalStall.collapsed = true;
            }
            
            // é‡æ–°åº”ç”¨ç­›é€‰æ¡ä»¶ä»¥æ›´æ–°æ˜¾ç¤º
            applyAllFilters();
        }

        // æ˜¾ç¤ºè¯„è®ºå¼¹çª—ï¼ˆä¿®å¤ç´¢å¼•é”™ä½é—®é¢˜ï¼‰
        function showComments(canteenName, stallName, dishIndex, type) {
            const canteen = canteensData.find(c => c.name === canteenName);
            if (!canteen) return;

            const stall = canteen.stalls.find(s => s.name === stallName);
            if (!stall) return;

            let targetData;
            if (type === 'dish') {
                if (!stall.dishes[dishIndex]) return;
                targetData = stall.dishes[dishIndex];
            } else {
                targetData = stall;
            }

            if (!targetData) return;

            currentModalData = {
                canteenName,
                stallName,
                dishIndex,
                type,
                data: targetData
            };

            // æ›´æ–°å¼¹çª—å†…å®¹
            document.getElementById('modalTitle').textContent = `${canteenName} - ${targetData.name}`;
            document.getElementById('modalRating').textContent = `${targetData.rating}â­`;
            
            // æ˜¾ç¤ºè¯„è®º
            const commentsList = document.getElementById('commentsList');
            if (targetData.comments && targetData.comments.length > 0) {
                commentsList.innerHTML = targetData.comments.map(comment => `
                    <div class="comment">
                        <div class="comment-header">
                            <div class="comment-author">${comment.author}</div>
                            <div class="comment-rating">${comment.rating}â­</div>
                        </div>
                        <div class="comment-date">${comment.date}</div>
                        <div class="comment-text">${comment.text}</div>
                    </div>
                `).join('');
            } else {
                commentsList.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">æš‚æ— è¯„ä»·ï¼Œå¿«æ¥æˆä¸ºç¬¬ä¸€ä¸ªè¯„ä»·çš„äººå§ï¼</p>';
            }

            // æ˜¾ç¤ºå¼¹çª—
            document.getElementById('commentModal').style.display = 'block';
        }

        // æ·»åŠ æ–°è¯„è®º
        function addComment() {
            const commentText = document.getElementById('commentText').value;
            const commentRating = document.getElementById('commentRating').value;
            
            if (!commentText || !commentRating) {
                alert('è¯·å¡«å†™å®Œæ•´çš„è¯„ä»·ä¿¡æ¯ï¼');
                return;
            }

            if (!currentModalData) return;

            const { canteenName, stallName, dishIndex, type } = currentModalData;
            const canteen = canteensData.find(c => c.name === canteenName);
            
            if (!canteen) return;
            
            const stall = canteen.stalls.find(s => s.name === stallName);
            if (!stall) return;

            let targetData;
            if (type === 'dish') {
                if (!stall.dishes[dishIndex]) return;
                targetData = stall.dishes[dishIndex];
            } else {
                targetData = stall;
            }

            if (!targetData) return;

            // æ·»åŠ æ–°è¯„è®º
            if (!targetData.comments) {
                targetData.comments = [];
            }

            const newComment = {
                author: 'æˆ‘',
                rating: parseFloat(commentRating),
                text: commentText,
                date: new Date().toLocaleDateString()
            };

            targetData.comments.unshift(newComment);

            // æ›´æ–°å¹³å‡è¯„åˆ†
            const totalRating = targetData.comments.reduce((sum, comment) => sum + comment.rating, 0);
            targetData.rating = (totalRating / targetData.comments.length).toFixed(1);

            // å¦‚æœæ˜¯èœå“è¯„è®ºï¼Œè¿˜éœ€è¦æ›´æ–°æ‘Šä½è¯„åˆ†
            if (type === 'dish') {
                stall.rating = calculateStallRating(stall.dishes);
            }

            // é‡æ–°æ¸²æŸ“é¡µé¢
            applyAllFilters();
            
            // æ›´æ–°å¼¹çª—å†…å®¹
            showComments(canteenName, stall.name, dishIndex, type);
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('commentText').value = '';
            document.getElementById('commentRating').value = '';
        }

        // å…³é—­å¼¹çª—
        function closeModal() {
            document.getElementById('commentModal').style.display = 'none';
            currentModalData = null;
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ¸²æŸ“
        document.addEventListener('DOMContentLoaded', function() {
            applyAllFilters();

            // å¢å¼ºæœç´¢åŠŸèƒ½ - é˜²æŠ–æœç´¢
            let searchTimeout;
            document.getElementById('searchInput').addEventListener('input', function(e) {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    searchCanteens(e.target.value);
                }, 300);
            });

            // å¼¹çª—å…³é—­åŠŸèƒ½
            document.querySelector('.close').addEventListener('click', closeModal);
            window.addEventListener('click', function(e) {
                const modal = document.getElementById('commentModal');
                if (e.target === modal) {
                    closeModal();
                }
            });

            // è¯„è®ºè¡¨å•æäº¤
            document.getElementById('commentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addComment();
            });
        });

        // æ·»åŠ ä¸€äº›äº¤äº’æ•ˆæœ
        document.addEventListener('DOMContentLoaded', function() {
            // ä¸ºèœå“å¡ç‰‡æ·»åŠ ç‚¹å‡»æ•ˆæœ
            document.addEventListener('click', function(e) {
                if (e.target.closest('.dish')) {
                    const dish = e.target.closest('.dish');
                    dish.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        dish.style.transform = 'scale(1)';
                    }, 150);
                }
            });
        });
        // æœç´¢å»ºè®®åŠŸèƒ½
        function initSearchSuggestions() {
            const searchInput = document.getElementById('searchInput');
            const suggestions = [
                'éº»è¾£é¦™é”…', 'ç•ªèŒ„é¸¡è›‹', 'çº¢çƒ§è‚‰', 'æ¸…ç‚’æ—¶è”¬', 'é…¸è¾£åœŸè±†ä¸',
                'å®«ä¿é¸¡ä¸', 'é±¼é¦™è‚‰ä¸', 'éº»å©†è±†è…', 'æ°´ç…®é±¼', 'å›é”…è‚‰',
                'ä¸è¾£', 'å¾®è¾£', 'ä¸­è¾£', 'ç‰¹è¾£', 'å˜æ€è¾£',
                'ç¬¬ä¸€é£Ÿå ‚', 'ç¬¬äºŒé£Ÿå ‚', 'ç¬¬ä¸‰é£Ÿå ‚', 'ç¬¬å››é£Ÿå ‚', 'ç¬¬äº”é£Ÿå ‚',
                '10å…ƒä»¥ä¸‹', '10-15å…ƒ', '15-20å…ƒ', '20å…ƒä»¥ä¸Š',
                '4.5åˆ†ä»¥ä¸Š', '4.0åˆ†ä»¥ä¸Š', '3.5åˆ†ä»¥ä¸Š',
                'ç´ é£Ÿ', 'è¤èœ', 'æ±¤ç±»', 'ä¸»é£Ÿ', 'å°åƒ'
            ];

            let suggestionsDiv = document.getElementById('searchSuggestions');
            if (!suggestionsDiv) {
                suggestionsDiv = document.createElement('div');
                suggestionsDiv.id = 'searchSuggestions';
                suggestionsDiv.style.cssText = `
                    position: absolute;
                    top: 100%;
                    left: 0;
                    right: 0;
                    background: white;
                    border: 1px solid #ddd;
                    border-radius: 8px;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                    z-index: 1000;
                    max-height: 200px;
                    overflow-y: auto;
                    display: none;
                `;
                
                const searchBar = document.querySelector('.search-bar');
                if (searchBar) {
                    searchBar.style.position = 'relative';
                    searchBar.appendChild(suggestionsDiv);
                }
            }

            // æœç´¢å»ºè®®äº‹ä»¶å¤„ç†
            searchInput.addEventListener('focus', function() {
                if (this.value.length > 0) {
                    showFilteredSuggestions(this.value, suggestions);
                } else {
                    showAllSuggestions(suggestions);
                }
            });

            searchInput.addEventListener('input', function() {
                if (this.value.length > 0) {
                    showFilteredSuggestions(this.value, suggestions);
                } else {
                    showAllSuggestions(suggestions);
                }
            });

            searchInput.addEventListener('blur', function() {
                setTimeout(() => {
                    suggestionsDiv.style.display = 'none';
                }, 200);
            });

            function showAllSuggestions(suggestions) {
                suggestionsDiv.innerHTML = suggestions.map(suggestion => `
                    <div style="padding: 8px 15px; cursor: pointer; border-bottom: 1px solid #eee; transition: background 0.2s;"
                         onmouseover="this.style.background='#f8f9fa'"
                         onmouseout="this.style.background='white'"
                         onclick="document.getElementById('searchInput').value='${suggestion}'; searchCanteens('${suggestion}')">
                        <span style="color: #3498db;">ğŸ’¡</span> ${suggestion}
                    </div>
                `).join('');
                suggestionsDiv.style.display = 'block';
            }

            function showFilteredSuggestions(query, suggestions) {
                const filtered = suggestions.filter(s => 
                    s.toLowerCase().includes(query.toLowerCase())
                ).slice(0, 8);
                
                if (filtered.length > 0) {
                    suggestionsDiv.innerHTML = filtered.map(suggestion => `
                        <div style="padding: 8px 15px; cursor: pointer; border-bottom: 1px solid #eee; transition: background 0.2s;"
                             onmouseover="this.style.background='#f8f9fa'"
                             onmouseout="this.style.background='white'"
                             onclick="document.getElementById('searchInput').value='${suggestion}'; searchCanteens('${suggestion}')">
                            <span style="color: #3498db;">ğŸ”</span> ${suggestion}
                        </div>
                    `).join('');
                    suggestionsDiv.style.display = 'block';
                } else {
                    suggestionsDiv.style.display = 'none';
                }
            }
        }

        // æœç´¢å¿«æ·é”®æ”¯æŒ
        function initSearchShortcuts() {
            const searchInput = document.getElementById('searchInput');
            
            document.addEventListener('keydown', function(e) {
                if (e.key === '/' && !e.ctrlKey && !e.altKey && !e.metaKey) {
                    if (document.activeElement !== searchInput) {
                        e.preventDefault();
                        searchInput.focus();
                    }
                }
                
                if (e.key === 'Escape') {
                    if (document.activeElement === searchInput) {
                        searchInput.blur();
                        searchInput.value = '';
                        searchCanteens('');
                    }
                }
            });
        }

        // å¢å¼ºçš„æœç´¢ç»Ÿè®¡åŠŸèƒ½
        function updateSearchStats(query, results) {
            const totalDishes = results.reduce((sum, canteen) => 
                sum + canteen.stalls.reduce((stallSum, stall) => 
                    stallSum + stall.dishes.length, 0), 0);
            
            let statsDiv = document.getElementById('searchStats');
            if (!statsDiv) {
                statsDiv = document.createElement('div');
                statsDiv.id = 'searchStats';
                statsDiv.style.cssText = `
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 12px 18px;
                    margin: 10px 0;
                    border-radius: 10px;
                    font-size: 14px;
                    font-weight: 500;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                    transition: all 0.3s ease;
                `;
                
                const searchBar = document.querySelector('.search-bar');
                if (searchBar) {
                    searchBar.appendChild(statsDiv);
                }
            }
            
            if (query && query.trim()) {
                if (totalDishes > 0) {
                    statsDiv.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span>ğŸ”</span>
                            <span>æœç´¢ "<strong>${query}</strong>" æ‰¾åˆ° <strong>${totalDishes}</strong> é“èœå“ï¼Œåˆ†å¸ƒåœ¨ <strong>${results.length}</strong> æ ‹é¤é¥®å¤§æ¥¼</span>
                            <button onclick="clearSearch()" style="margin-left: auto; background: rgba(255,255,255,0.2); border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">æ¸…é™¤</button>
                        </div>
                    `;
                    statsDiv.style.display = 'block';
                } else {
                    statsDiv.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span>ğŸ˜…</span>
                            <span>æœç´¢ "<strong>${query}</strong>" æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</span>
                            <button onclick="clearSearch()" style="margin-left: auto; background: rgba(255,255,255,0.2); border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">æ¸…é™¤</button>
                        </div>
                    `;
                    statsDiv.style.display = 'block';
                }
            } else {
                statsDiv.style.display = 'none';
            }
        }

        function clearSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.value = '';
            searchCanteens('');
            searchInput.focus();
        }

        // åˆå§‹åŒ–æ‰€æœ‰æœç´¢åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            initSearchSuggestions();
            initSearchShortcuts();
        });
    </script>
</body>
</html>
